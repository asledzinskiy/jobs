- job-template:
    name: update-jenkins-jobs
    description: |
      Update jenkins jobs after the merge event
    node: tools
    builders:
      - shell:
          !include-raw-escape: builders/update-jenkins-jobs.sh
    concurrent: true
    scm:
      - git:
          branches:
            - 'master'
          remotes:
            - gerrit:
                url: 'ssh://mcp-ci-gerrit@{gerrit-url}:29418/mcp-ci/project-config.git'
                credentials-id: 'mcp-ci-gerrit'
          skip-tag: true
    triggers:
      - timed: 'H * * * *'
      - gerrit:
          trigger-on:
            - change-merged-event
          projects:
            - project-compare-type: PLAIN
              project-pattern: 'mcp-ci/project-config'
              branches:
                - branch-compare-type: ANT
                  branch-pattern: '**'
          custom-url: '* $JOB_NAME $BUILD_URL'
    wrappers:
      - credentials-binding:
          - username-password-separated:
              credential-id: 'jjb-updater'
              username: JJB_USER
              password: JJB_PASS
