- job-template:
    name: mcp-k8s-images
    description: |
      Kubernetes unit and integration tests images build job
    node: k8s
    concurrent: false
    scm:
      - git:
          branches:
            - 'master'
          remotes:
            - gerrit:
                url: 'ssh://mcp-ci-gerrit@{gerrit-host}:29418/mcp-ci/mcp-cicd-poc'
                credentials-id: 'mcp-ci-gerrit'
    builders:
      - inject:
          properties-content: |
            DOCKER_REGISTRY={k8s-tests-registry}
            DOCKER_REPOSITORY=k8s-tests-images
      - shell:
          !include-raw-escape: builders/mcp-k8s-images.sh
    wrappers:
      - workspace-cleanup
      - ssh-agent-credentials:
          users:
            - 'mcp-ci-gerrit'
      - credentials-binding:
          - username-password-separated:
              credential-id: 'artifactory'
              username: ARTIFACTORY_LOGIN
              password: ARTIFACTORY_PASSWORD
