- job-template:
    name: prepare-slave-nodes
    description: |
      Job to deploy Jenkins slave configuration on a selected server
    node: tools
    concurrent: true
    parameters:
      - string:
          name: USERNAME
          default: 'ubuntu'
          description: 'Username used for ansible when connecting to the sshd daemon on a remote host'
      - string:
          name: BRANCH_NAME
          default: 'master'
          description: 'The branch name of mcp-cicd-poc repo to use'
      - string:
          name: HOSTS_LIST
          default: localhost
          description: 'A space separated list of hosts to provision'
    builders:
      - shell:
          !include-raw-escape: builders/prepare-slave-nodes.sh
    scm:
      - git:
         remotes:
           - gerrit:
               url: 'ssh://mcp-ci-gerrit@{gerrit-host}:29418/mcp-ci/mcp-cicd-poc'
               credentials-id: 'mcp-ci-gerrit'
         branches:
           - '$BRANCH_NAME'
         skip-tag: true
    wrappers:
      - ssh-agent-credentials:
          users:
            - 'jenkins'
