- job-template:
    name: ccp-docker-build
    description: |
      Fuel CCP - CCP image builder container
    project-type: workflow

    parameters:
      - string:
          name: DOCKER_REGISTRY
          default: '{docker-dev-virtual}'
          description: 'Docker registry for binaries and images'

    triggers:
      - gerrit:
          trigger-on:
            - change-merged-event
          projects:
            - project-compare-type: REG_EXP
              project-pattern: '^ccp/fuel-ccp($|\-(?!docker|ci-config))'
              branches:
                - branch-compare-type: PLAIN
                  branch-pattern: 'master'
          custom-url: '* $JOB_NAME $BUILD_URL'

    workflow-scm:
      scm:
        basic-scm:
          branch: 'master'
          project: 'ccp/fuel-ccp-docker'
          gerrit-host: '{gerrit-host}'
          gerrit-port: '{gerrit-port}'
      script-path: Jenkinsfile

